<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../iron-image/iron-image.html">
<link rel="import" href="../caas-campaign/caas-campaign.html">
<link rel="import" href="../caas-campaign-stats/caas-campaign-stats.html">
<link rel="import" href="../placetobe-styles/placetobe-styles.html">
<link rel="import" href="../placetobe-campaign-progress-bar/placetobe-campaign-progress-bar.html">

<!--
`placetobe-campaign-card`
Placetobe Campaign Card

@demo demo/index.html 
-->

<dom-module id="placetobe-campaign-card">
  <template>
    <style>

      :host {
        display: block;
      }

      :host #container {
        color: var(--placetobe-color-darkblue);
        position: relative;
        z-index: 0;
        display: flex;
        flex-direction: column;
        align-items: stretch;
        flex: 1;
      }

      :host[horizontal-layout] #container {
        flex-direction: row-reverse;
        align-items: stretch;
      }

      :host #link {
        position: absolute;
        top: -18px;
        right: -18px;
        bottom: -18px;
        left: -18px;
        background-color: transparent;
        content: "";
        z-index: 3;        
      }

      :host[has-link] #container:hover:after {
        position: absolute;
        top: -18px;
        right: -18px;
        bottom: -18px;
        left: -18px;
        background-color: var(--placetobe-color-yellow);
        content: "";
        z-index: 0;
      }

      :host iron-image {
        width: 100%;
        height: 172px;
        position: relative;
        z-index: 1;
      }

      :host[horizontal-layout] iron-image {
        height: auto;
        flex:2;
      }

      :host section {
        position: relative;
        z-index: 1;
        display: flex;
        flex-direction: column;
        padding-right: 72px;
        flex:1;
      }

      :host h6 {
        @apply(--placetobe-font-body-small);
        margin: 18px 0 9px 0;
      }

      :host h2 {
        @apply(--placetobe-font-heading1-small);
      }

      :host h3 {
        @apply(--placetobe-font-heading3-bold-small);
        color: var(--placetobe-color-green);
        margin-top: 18px;
      }

      :host placetobe-campaign-progress-bar {
        --placetobe-campaign-progress-bar-background-color: var(--placetobe-color-darkblue);
        margin: 9px 0 24px 0;
      }

      :host article {
        @apply(--placetobe-font-body-small);
        margin: 9px 0;
      }

      :host main {
        flex: 1;
      }

      :host footer {
        @apply(--placetobe-font-body-serif-small);
      }

      :host .button {
        @apply(--placetobe-default-button-small);
        margin-top: 18px;
        background-color: var(--placetobe-color-darkblue);
        box-shadow: 0 3px 0 white;
        color: white;
      }

      :host .rolling-container {
        height: 58px;
        overflow: hidden;
      }

      :host .rolling-content[data-rolling] {
        transition: 0.25s transform ease-in-out;        
      }

      :host #container:hover .rolling-content[data-rolling] {
        transform: translateY(-66px);
      }      

    </style>

    <caas-campaign
      api-endpoint="[[apiEndpoint]]"
      id="[[campaignId]]"
      title="{{title}}"
      introduction-text="{{introductionText}}"
      image-url="{{imageUrl}}"
      body-text="{{campaignText}}"
    ></caas-campaign>

    <caas-campaign-stats
      api-endpoint="[[apiEndpoint]]"
      campaign-id="[[campaignId]]"
      number-of-funders="{{numberOfFunders}}"
      required-funding="{{requiredFunding}}"
      maximum-funding="{{maximumFunding}}"
      currently-funded="{{currentlyFunded}}"
      days-left="{{daysLeft}}"
      labels="{{labels}}"
      closed="{{closed}}"
      status-label="{{statusLabel}}"
    ></caas-campaign-stats>


    <div id="container">

      <a id="link" href$="[[href]]" hidden$="[[!hasLink]]"></a>

      <iron-image
        src$="[[imageUrl]]"
        sizing="cover"
      ></iron-image>
      
      <section>
        
        <header>
          <h6>[[labels]] campagne</h6>
          <h2>[[title]]</h2>
        </header>

        <main>
          <article>
          [[introductionText]]
          </article>
        </main>
        
        <footer>
          <h3>â‚¬[[currentlyFunded]]</h3>
          <placetobe-campaign-progress-bar
            required-funding="[[requiredFunding]]"
            maximum-funding="[[maximumFunding]]"
            currently-funded="[[currentlyFunded]]"
            text-below
          ></placetobe-campaign-progress-bar>

          <div class="rolling-container">
            <div class="rolling-content" data-rolling$="[[hasLink]]">
              <strong>[[numberOfFunders]]</strong> investeerders<br>
              <span hidden$="[[closed]]">nog <strong>[[daysLeft]]</strong> dagen<br></span>
              <span hidden$="[[!closed]]">deze campagne is [[statusLabel]]</span>
              <br>
              <a class="button">Bekijk project</a>
            </div>
          </div>
        </footer>

      </section>

    </div>

  </template>

  <script>
    Polymer({

      is: 'placetobe-campaign-card',

      properties: {

        campaignId: {
          type: String,
          value: null
        },

        apiEndpoint: {
          type: String,
          value: null
        },

        href: {
          type: String,
          value: null,
        },

        hasLink: {
          type: Boolean,
          computed: '_computeHasLink(href)',
          reflectToAttribute: true,
          notify: true
        },

        horizontalLayout: {
          type: Boolean,
          value: false,
          reflectToAttribute: true
        }

      },

      _computeHasLink: function(href) {
        return (!!href);
      }

    });
  </script>
</dom-module>
